<!--pages/protocol/protocol.wxml-->
<wxs src="../../utils/uiUtils/dateUtil.wxs" module="util" />
<view class='protocolBox'>
  <view class='protocolMess'>
     <view class='carNameBox'>
        <span>会员卡</span>
        <span>{{cardMess.contract.cardName}}</span>
      </view>
      <view class='carNameBox'>
        <span>有效期</span>
        <span>{{cardMess.contract.remainEffectiveDays}}</span>
      </view>
      <view class='buyCarMess'>
         <view class='carNameBox leftBox' wx:if="{{cardMess.contract.cardType==5}}">
          <span>购买金额</span>
          <span style="width:80rpx;">{{cardMess.contract.buyAmount}}元</span>
        </view>
         <view class='carNameBox leftBox' wx:if="{{cardMess.contract.cardType==4||cardMess.contract.cardType==7}}">
          <span>购买次数</span>
          <span style="width:80rpx;">{{cardMess.contract.buyCount}}次</span>
        </view>
         <view class='carNameBox leftBox' wx:if="{{cardMess.contract.cardType==3||cardMess.contract.cardType==6||cardMess.contract.buyEffectiveDays==null}}">
          <span>购买天数</span>
          <span style="width:80rpx;">{{cardMess.contract.buyEffectiveDays}}天</span>
        </view>
        <view class='carNameBox'>
          <span>开卡方式</span>
          <span wx:if="{{cardMess.contract.activateMode==1}}">立即开卡</span>
          <span wx:if="{{cardMess.contract.activateMode==2}}">{{cardMess.contract.beActivatedInDays}}天内开卡</span>
          <span wx:if="{{cardMess.contract.activateMode==3}}">指定日期开卡</span>
          <span wx:if="{{cardMess.contract.activateMode==4}}">首次使用开卡</span>
        </view>
      </view>
      <view class='buyCarMess'>
        <view class='carNameBox leftBox' wx:if="{{cardMess.contract.cardType==5}}">
          <span>赠送金额</span>
          <span style="width:80rpx;">{{cardMess.contract.freeAmount||'--'}}元</span>
        </view>
        <view class='carNameBox leftBox' wx:if="{{cardMess.contract.cardType==4||cardMess.contract.cardType==7}}">
          <span>赠送次数</span>
          <span style="width:80rpx;">{{cardMess.contract.freeCount||'--'}}次</span>
        </view>
        <view class='carNameBox leftBox' wx:if="{{cardMess.contract.cardType==3||cardMess.contract.cardType==6}}">
          <span>赠送天数</span>
          <span style="width:80rpx;">{{cardMess.contract.freeEffectiveDays||'--'}}天</span>
        </view>
        <view class='carNameBox'>
          <span>合同金额</span>
          <span>¥{{cardMess.price}}</span>
        </view>
      </view>
  </view>
  <view class='useOfficeBox clearfix'>
    <span>可用门店</span>
    <view class='centerListBox'>
      <span wx:for="{{centerList}}" class="useOffice" wx:key='index'>{{item}} </span>
    </view>
  </view>
  <view class='officeBox wideBorder'>
     <view class='carNameBox'>
        <span>合同备注</span>
        <span>{{cardMess.contract.remarks==null?'-':cardMess.contract.remarks}}</span>
      </view>
  </view>
  <view class='buyerMess'>
    <view class='buyerName carNameBox'>
      <span>购买人</span>
      <span>{{cardMess.traineeInfo.name||'----'}}</span>
    </view>
    <view class='buyerPhone carNameBox'>
      <span>手机号</span>
      <span>{{cardMess.traineeInfo.phone||'----'}}</span>
    </view>
     <view class='buyerName carNameBox'>
      <span>证件类型</span>
      <span>{{cardMess.traineeInfo.idType||'----'}}</span>
    </view>
    <view class='buyerPhone carNameBox'>
      <span>证件号</span>
      <span>{{cardMess.traineeInfo.idNumber||'----'}}</span>
    </view>
  </view>
  <view class='salespersonBox' wx:if="{{cardMess.consultant.name}}">
     <view class='carNameBox'>
          <span>销售人</span>
          <span>{{cardMess.consultant.name}}</span>
        </view>
  </view>
  <view class='signBox'>
    <view class='officeSign'>
      <span>场馆签字/印章</span>
      <image src='{{cardMess.centerSign||"../../images/agree.png"}}' mode='aspectFit'></image>
    </view>
     <view class='officeSign'>
      <span>会员签字</span>
      <!-- <span class="nosign" wx:if="{{!noPic&&!cardMess.requireSign||!isShow}}">未签名</span>
      <image src='{{signImg}}' class='noBorder' mode='aspectFit' wx:if="{{noPic&&cardMess.requireSign}}"></image>
      <image class='seal noBorder' src='../../images/agree.png' wx:if="{{!cardMess.requireSign&&noPic}}"></image> -->
       
       <span class="nosign" wx:if="{{!noPic&&!cardMess.requireSign||!isShow}}">未签名</span>
        <view wx:if="{{noPic&&cardMess.requireSign}}" style='width: 260rpx;height: 120rpx;'>
          <image  src='{{signImg}}' class='noBorder' mode='aspectFit' style='width: 260rpx;height: 120rpx;'></image>
        </view>
        <view  wx:if="{{!cardMess.requireSign&&noPic}}">
         <image class='seal noBorder' src='../../images/agree.png' mode='aspectFit'></image>
       </view>
    </view>
  </view>
  <view class='protocolServe' wx:if="{{cardMess.protocol!=null}}">
    <span class="title">服务协议</span>
    <span class="edition">协议版本号：{{cardMess.protocol.version}}</span>
    <span class="releaseTime">发布日期：{{util.formatTimec(cardMess.protocol.issueTime)}}</span>
    <view class='richTxt'>
      <text>{{cardMess.protocol.protocolContent}}</text>
    </view>
  </view>
  <view class='signBtn'>
    <span bindtap="showSignPop"  wx:if="{{cardMess.requireSign&&!isShowSign}}">签字</span>
    <span bindtap="goPay"  wx:if="{{showPay}}">支付</span>
    <span  wx:if="{{!cardMess.requireSign&&!noPic}}" bindtap='confirm'>确认</span>
    <!-- <span>同意</span> -->
  </view>
</view>
<view class='popBox'  catchtouchmove="prevent" wx:if="{{showSignBox}}">
  <view class='popSignBox'>
    <!-- <view class='popTitle'>
      <span></span>
      <span>签字</span>
      <image src='../../images/closeRule.png' class='popCancel' bindtap='cancelEvent'></image>
    </view>
     <canvas class="canvas" id="canvas" canvas-id="canvas" disable-scroll="true" bindtouchstart="canvasStart" bindtouchmove="canvasMove" bindtouchend="canvasEnd" touchcancel="canvasEnd" binderror="canvasIdErrorCallback"></canvas>
    <view class='btnGroup'>
      <span bindtap="cancelEvent">清除</span>
      <span bindtap='clickMe'>确认</span>
    </view> -->
      <view class='imgButtonBox'>
      <image src='../../images/fontReturn.png' class='returnBtn' bindtap='cancelEvent'></image>
      <view class='submitBtnBox'>
        <image src='../../images/fontClear.png' class='returnBtn' bindtap="cancelEvent"></image>
        <image src='../../images/fontSubmit.png' class='returnBtn' style='margin-top:30rpx;height:220rpx;' bindtap='clickMe'></image>
      </view>
    </view>
    <canvas class="canvas" id="canvas" canvas-id="canvas" disable-scroll="true" bindtouchstart="canvasStart" bindtouchmove="canvasMove" bindtouchend="canvasEnd" touchcancel="canvasEnd" binderror="canvasIdErrorCallback" style='width:{{canvasWidth}}px;height:{{canvasHeight}}px'></canvas>
    <canvas class="canvas2" id="canvas2" canvas-id="canvas2" disable-scroll="true"   style='width:300px;height:180px'></canvas>
     <view class='signTitle'>
      <image src='../../images/signTitle.png'></image>
    </view>
  </view>
</view>


<view wx:if="{{signersError}}" class='tip_bgview'></view>
<view wx:if="{{signersError}}" class='tip_view'>
  <view class='tit'>非本人扫码</view>
  <navigator open-type="exit" target="miniProgram">确定</navigator>
</view>